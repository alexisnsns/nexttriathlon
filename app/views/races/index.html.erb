<div class="container">
  <div class="col-sm">
    <h4 class="mt-3"><%= @races.size %> available races</h4>
    <%= form_tag(@race_path, method: "get", id: "search-form", class: "form-inline mb-3 mt-3") do %>
      <div class="input-group">
        <%= text_field_tag :search, params[:search], placeholder: "Search by title", class: "form-control" %>
        <div class="input-group-append">
          <%= submit_tag "Search", name: nil, class: "btn btn-primary" %>
        </div>
      </div>
    <% end %>
    <div class="row">
      <div class="col-sm-7">
        <% @races.order(:date).each do |race| %>
          <div class="card-product mb-3">
            <%= cl_image_tag race.photo.key %>
            <div class="card-product-infos">
              <h2><%= link_to race.title.capitalize, race %></h2>
              <p> (<%= race.format.join(' - ') %> / <%= race.date.strftime("%d-%m") %>)
              </p>
              <p> 🏊 <%= race.swim %> 🚴 <%= race.bike %> 🏃 <%= race.run %></p>
            </div>
          </div>
        <% end %>
      </div>
      <div class="col-sm-5">
        <div style="width: 100%; height: 50%;"
          data-controller="maphome"
          data-maphome-markers-value="<%= @markers.to_json %>"
          data-maphome-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>"></div>
      </div>
    </div>
  </div>
